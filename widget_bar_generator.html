<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>G√©n√©rateur Widget Bar - CDC2025</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0f14;
      --card: rgba(0,0,0,0.4);
      --text: #f2f5f8;
      --muted: #96a0aa;
      --accent: #FCA000;
  --accent-2: #104E59;
  --radius: 12px;
  --numbers: #ffffff;
  --logo-gradient-start: #FFE259;
  --logo-gradient-end: #FFA751;
    }

    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Outfit', -apple-system, system-ui;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    h1 {
      color: #FCA000;
      margin: 0 0 20px 0;
    }

    .content {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .full-preview {
      margin-top: 20px;
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      overflow: hidden;
    }

    .preview-container {
      width: 100%;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: rgba(0,0,0,0.2);
      border-radius: var(--radius);
      padding: 10px 0;
    }

    .full-preview iframe {
      width: 100%;
      height: 100px;
      border: none;
    }

    .controls {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .preview {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section-content {
      display: flex;
      gap: 20px;
    }

    .section-controls {
      flex: 1;
    }

    .section-preview {
      flex: 1;
      min-width: 400px;
      background: rgba(0,0,0,0.2);
      border-radius: var(--radius);
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .preview-sample {
      padding: 20px;
      border-radius: var(--radius);
      background: var(--glass);
      width: 100%;
    }

    .preview-colors-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .preview-label {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .preview-accent {
      font-size: 28px;
      font-weight: bold;
      color: var(--accent);
    }

    .preview-text {
      font-size: 28px;
      color: var(--text);
    }

    .preview-numbers {
      font-size: 28px;
      color: var(--numbers);
    }

    .preview-rainbow {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(90deg, var(--logo-gradient-start), var(--logo-gradient-end));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      color: transparent;
    }

    .field-inline {
      display: flex;
      gap: 15px;
    }

    .field-group {
      flex: 1;
    }

    .small-input {
      width: 100%;
    }

    .preview-bg {
      background: var(--bar-bg);
      padding: 20px;
      border-radius: var(--radius);
    }

    .preview-scale {
      font-size: calc(24px * var(--fs));
      color: var(--text);
    }

    .preview-hashtag {
      font-size: 24px;
      color: var(--text);
    }

    .preview-logo {
      height: 40px;
      object-fit: contain;
    }

    .preview-placeholder {
      font-size: 18px;
      color: var(--muted);
    }

    h2 {
      color: #FCA000;
      margin: 0;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    h2 .icon {
      font-size: 1.2em;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
    }

    .field:last-child {
      margin-bottom: 0;
    }

    label {
      font-size: 0.9em;
      color: var(--muted);
    }

    input[type="text"],
    input[type="color"],
    input[type="number"],
    input[type="url"] {
      background: rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 8px 12px;
      border-radius: 6px;
      color: var(--text);
      font-family: inherit;
      font-size: 0.95em;
    }

    input[type="color"] {
      padding: 2px 4px;
      height: 36px;
    }

    .generated-url {
      background: rgba(0,0,0,0.2);
      padding: 12px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 0.9em;
      white-space: pre-wrap;
      word-break: break-all;
      color: #a7e3bd;
      margin-top: 12px;
    }

    .preview iframe {
      border: none;
      width: 100%;
      height: 200px;
      border-radius: var(--radius);
      background: rgba(0,0,0,0.2);
    }

    .copy-button {
      background: #FCA000;
      color: black;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 600;
      transition: opacity 0.2s;
    }

    .copy-button:hover {
      opacity: 0.9;
    }

    .copy-button:active {
      opacity: 0.8;
    }

    .tooltip {
      position: fixed;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 0.9em;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>G√©n√©rateur Widget Bar - CDC2025</h1>
    
    <div class="content">
      <div class="section">
        <h2><span class="icon">üé®</span> Personnalisation</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>Couleur d'accent</label>
              <input type="color" id="accent" value="#FCA000">
            </div>
            <div class="field">
              <label>Couleur du texte principal</label>
              <input type="color" id="text" value="#f2f5f8">
            </div>
            <div class="field">
              <label>Couleur des chiffres</label>
              <input type="color" id="numbers" value="#ffffff">
            </div>
            <div class="field">
              <label>D√©grad√© titre gauche ‚Äî couleur 1</label>
              <input type="color" id="logoGradientStart" value="#FFE259">
            </div>
            <div class="field">
              <label>D√©grad√© titre gauche ‚Äî couleur 2</label>
              <input type="color" id="logoGradientEnd" value="#FFA751">
            </div>
            <div class="field">
              <label>Couleur de fond de la barre</label>
              <input type="color" id="barBg" value="#000000">
              <input type="text" id="barBgAlpha" value="0.4" placeholder="Opacit√© (0-1)">
            </div>
          </div>
          <div class="section-preview">
            <div class="preview-sample">
              <div class="preview-colors-grid">
                <div>
                  <div class="preview-label">Couleur stats (accent)</div>
                  <div class="preview-accent">Cagnotte &amp; titre droite</div>
                </div>
                <div>
                  <div class="preview-label">Titre gauche (d√©grad√©)</div>
                  <div class="preview-rainbow">CDC2025</div>
                </div>
                <div>
                  <div class="preview-label">Texte principal</div>
                  <div class="preview-text">viewers / en ligne</div>
                </div>
                <div>
                  <div class="preview-label">Chiffres</div>
                  <div class="preview-numbers">12 345 ‚Ç¨ ‚Ä¢ 256 viewers</div>
                </div>
                <div>
                  <div class="preview-label">Fond de la barre</div>
                  <div class="preview-bg">Aper√ßu du fond</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2><span class="icon">üìè</span> Taille du texte</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>√âchelle (1 = normal)</label>
              <input type="number" id="fontScale" value="1.0" min="0.5" max="2" step="0.1">
            </div>
          </div>
          <div class="section-preview">
            <div class="preview-sample">
              <div class="preview-scale">CDC2025</div>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2><span class="icon">üìù</span> Contenu</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>Texte fin de barre</label>
              <input type="text" id="hashtag" value="Protection Animale" placeholder="Protection Animale">
            </div>
            <div class="field">
              <label>√âmote + texte</label>
              <input type="url" id="logo" placeholder="URL de l'√©mote" class="small-input">
            </div>
          </div>
          <div class="section-preview">
              <div class="preview-sample">
                <div class="preview-label">Aper√ßu fin de barre</div>
                <div class="preview-text" id="preview-hashtag-text">Protection Animale</div>
                <div class="preview-label" style="margin-top: 20px">Aper√ßu √©mote + texte</div>
                <div class="preview-emote-group">
                  <img class="preview-logo" id="preview-logo-img" src="" style="display: none">
                  <span class="preview-placeholder" id="preview-logo-placeholder">Ajoutez une √©mote pour la pr√©visualiser</span>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2><span class="icon">üîó</span> URL G√©n√©r√©e</h2>
      <div class="generated-url" id="url"></div>
      <button class="copy-button" onclick="copyUrl()">Copier l'URL</button>
    </div>

    <div class="full-preview">
      <h2><span class="icon">üëÅÔ∏è</span> Aper√ßu complet</h2>
      <div class="preview-container">
        <iframe id="preview-full" src=""></iframe>
      </div>
    </div>
  </div>

  <script>
  const BASE_URL = 'Widget_Bar.html';
  const DEFAULTS = {
    accent: '#FCA000',
    text: '#f2f5f8',
    numbers: '#ffffff',
    logoGradientStart: '#FFE259',
    logoGradientEnd: '#FFA751',
    barBg: '#000000',
    barBgAlpha: '0.4',
    fontScale: '1.0',
    hashtag: 'Protection Animale'
  };
    let tooltip = null;

    function showTooltip(text, x, y) {
      if (!tooltip) {
        tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        document.body.appendChild(tooltip);
      }
      tooltip.textContent = text;
      tooltip.style.left = x + 'px';
      tooltip.style.top = y + 'px';
      tooltip.style.opacity = '1';
      
      setTimeout(() => {
        tooltip.style.opacity = '0';
        setTimeout(() => {
          if (tooltip) {
            tooltip.remove();
            tooltip = null;
          }
        }, 200);
      }, 2000);
    }

    async function copyUrl() {
      const url = document.getElementById('url').textContent;
      try {
        await navigator.clipboard.writeText(url);
        const button = document.querySelector('.copy-button');
        const rect = button.getBoundingClientRect();
        showTooltip('URL copi√©e !', rect.left, rect.top - 30);
      } catch (err) {
        console.error('Erreur lors de la copie:', err);
      }
    }

    function updateUrl() {
      const params = new URLSearchParams();

      // Personnalisation
      const accent = document.getElementById('accent').value;
      if (accent.toLowerCase() !== DEFAULTS.accent.toLowerCase()) {
        params.set('accent', accent);
      }

      const text = document.getElementById('text').value;
      if (text.toLowerCase() !== DEFAULTS.text.toLowerCase()) {
        params.set('text', text);
      }

      const numbers = document.getElementById('numbers').value;
      if (numbers.toLowerCase() !== DEFAULTS.numbers.toLowerCase()) {
        params.set('numbers', numbers);
      }

      const gradientStart = document.getElementById('logoGradientStart').value;
      if (gradientStart.toLowerCase() !== DEFAULTS.logoGradientStart.toLowerCase()) {
        params.set('logoGradientStart', gradientStart);
      }

      const gradientEnd = document.getElementById('logoGradientEnd').value;
      if (gradientEnd.toLowerCase() !== DEFAULTS.logoGradientEnd.toLowerCase()) {
        params.set('logoGradientEnd', gradientEnd);
      }

      const barBgHex = document.getElementById('barBg').value;
      const barBgAlpha = document.getElementById('barBgAlpha').value;
      const parsedBg = `rgba(${parseInt(barBgHex.slice(1, 3), 16)},${parseInt(barBgHex.slice(3, 5), 16)},${parseInt(barBgHex.slice(5, 7), 16)},${barBgAlpha})`;
      const isDefaultBg = barBgHex.toLowerCase() === DEFAULTS.barBg.toLowerCase() && barBgAlpha === DEFAULTS.barBgAlpha;
      if (!isDefaultBg) {
        params.set('barBg', parsedBg);
      }

      // Taille du texte
      const fontScale = document.getElementById('fontScale').value;
      if (fontScale !== DEFAULTS.fontScale) {
        params.set('fs', fontScale);
      }

      // Contenu
      const hashtagInput = document.getElementById('hashtag');
      const hashtag = hashtagInput.value.trim();
      if (hashtag && hashtag !== DEFAULTS.hashtag) {
        params.set('hashtag', hashtag);
      }

      const logoInput = document.getElementById('logo');
      const logo = logoInput.value.trim();
      if (logo) {
        params.set('logo', logo);
      }

      // G√©n√©rer l'URL finale
      const url = `${BASE_URL}${params.toString() ? '?' + params.toString() : ''}`;

      // Mettre √† jour l'affichage
      document.getElementById('url').textContent = url;
      document.getElementById('preview-full').src = url;

      const defaultBgRgba = `rgba(${parseInt(DEFAULTS.barBg.slice(1, 3), 16)},${parseInt(DEFAULTS.barBg.slice(3, 5), 16)},${parseInt(DEFAULTS.barBg.slice(5, 7), 16)},${DEFAULTS.barBgAlpha})`;

      // Mettre √† jour les aper√ßus simplifi√©s
      document.documentElement.style.setProperty('--accent', accent);
      document.documentElement.style.setProperty('--text', text);
      document.documentElement.style.setProperty('--numbers', numbers);
      document.documentElement.style.setProperty('--logo-gradient-start', gradientStart);
      document.documentElement.style.setProperty('--logo-gradient-end', gradientEnd);
      document.documentElement.style.setProperty('--bar-bg', isDefaultBg ? defaultBgRgba : parsedBg);
      document.documentElement.style.setProperty('--fs', fontScale);

      // Mettre √† jour le contenu
      document.getElementById('preview-hashtag-text').textContent = hashtag || DEFAULTS.hashtag;
      const logoImg = document.getElementById('preview-logo-img');
      const logoPlaceholder = document.getElementById('preview-logo-placeholder');

      if (logo) {
        logoImg.src = logo;
        logoImg.style.display = 'block';
        if (logoPlaceholder) {
          logoPlaceholder.style.display = 'none';
        }
      } else {
        logoImg.style.display = 'none';
        logoImg.removeAttribute('src');
        if (logoPlaceholder) {
          logoPlaceholder.style.display = 'inline';
        }
      }
    }

    // Ajouter les √©v√©nements sur tous les champs
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', updateUrl);
    });

    // Initialiser l'URL
    updateUrl();
  </script>
</body>
</html>