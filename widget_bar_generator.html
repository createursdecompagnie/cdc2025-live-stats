<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>G√©n√©rateur Widget Bar - CDC2025</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0f14;
      --card: rgba(0,0,0,0.4);
      --text: #f2f5f8;
      --muted: #96a0aa;
      --accent: #FCA000;
      --accent-2: #104E59;
      --radius: 12px;
    }

    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Outfit', -apple-system, system-ui;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    h1 {
      color: var(--accent);
      margin: 0 0 20px 0;
    }

    .content {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    .full-preview {
      margin-top: 20px;
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
    }

    .full-preview iframe {
      width: 100%;
      height: 180px;
      border: none;
      border-radius: var(--radius);
      background: rgba(0,0,0,0.2);
    }

    .controls {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .preview {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section {
      background: var(--card);
      padding: 20px;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section-content {
      display: flex;
      gap: 20px;
    }

    .section-controls {
      flex: 1;
    }

    .section-preview {
      width: 300px;
      background: rgba(0,0,0,0.2);
      border-radius: var(--radius);
      padding: 10px;
    }

    .section-preview iframe {
      width: 100%;
      height: 100px;
      border: none;
      border-radius: calc(var(--radius) - 4px);
      background: rgba(0,0,0,0.2);
    }

    h2 {
      color: var(--accent);
      margin: 0;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    h2 .icon {
      font-size: 1.2em;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
    }

    .field:last-child {
      margin-bottom: 0;
    }

    label {
      font-size: 0.9em;
      color: var(--muted);
    }

    input[type="text"],
    input[type="color"],
    input[type="number"],
    input[type="url"] {
      background: rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 8px 12px;
      border-radius: 6px;
      color: var(--text);
      font-family: inherit;
      font-size: 0.95em;
    }

    input[type="color"] {
      padding: 2px 4px;
      height: 36px;
    }

    .generated-url {
      background: rgba(0,0,0,0.2);
      padding: 12px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 0.9em;
      white-space: pre-wrap;
      word-break: break-all;
      color: #a7e3bd;
      margin-top: 12px;
    }

    .preview iframe {
      border: none;
      width: 100%;
      height: 200px;
      border-radius: var(--radius);
      background: rgba(0,0,0,0.2);
    }

    .copy-button {
      background: var(--accent);
      color: black;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 600;
      transition: opacity 0.2s;
    }

    .copy-button:hover {
      opacity: 0.9;
    }

    .copy-button:active {
      opacity: 0.8;
    }

    .tooltip {
      position: fixed;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 0.9em;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>G√©n√©rateur Widget Bar - CDC2025</h1>
    
    <div class="content">
      <div class="section">
        <h2><span class="icon">üé®</span> Personnalisation</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>Couleur d'accent</label>
              <input type="color" id="accent" value="#FCA000">
            </div>
            <div class="field">
              <label>Couleur du texte principal</label>
              <input type="color" id="text" value="#f2f5f8">
            </div>
            <div class="field">
              <label>Couleur du texte secondaire</label>
              <input type="color" id="muted" value="#96a0aa">
            </div>
            <div class="field">
              <label>Couleur de fond de la barre</label>
              <input type="color" id="barBg" value="#000000">
              <input type="text" id="barBgAlpha" value="0.4" placeholder="Opacit√© (0-1)">
            </div>
          </div>
          <div class="section-preview">
            <iframe id="preview-colors" src=""></iframe>
          </div>
        </div>
      </div>

      <div class="section">
        <h2><span class="icon">üìè</span> Taille du texte</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>√âchelle (1 = normal)</label>
              <input type="number" id="fontScale" value="1.0" min="0.5" max="2" step="0.1">
            </div>
          </div>
          <div class="section-preview">
            <iframe id="preview-font" src=""></iframe>
          </div>
        </div>
      </div>

      <div class="section">
        <h2><span class="icon">üìù</span> Contenu</h2>
        <div class="section-content">
          <div class="section-controls">
            <div class="field">
              <label>Hashtag</label>
              <input type="text" id="hashtag" value="#CDC2025" placeholder="#CDC2025">
            </div>
            <div class="field">
              <label>URL du Logo</label>
              <input type="url" id="logo" placeholder="https://exemple.com/logo.png">
            </div>
          </div>
          <div class="section-preview">
            <iframe id="preview-content" src=""></iframe>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2><span class="icon">üîó</span> URL G√©n√©r√©e</h2>
      <div class="generated-url" id="url"></div>
      <button class="copy-button" onclick="copyUrl()">Copier l'URL</button>
    </div>

    <div class="full-preview">
      <h2><span class="icon">üëÅÔ∏è</span> Aper√ßu complet</h2>
      <iframe id="preview-full" src=""></iframe>
    </div>
  </div>

  <script>
    const BASE_URL = 'https://createursdecompagnie.github.io/cdc2025-live-stats/Widget_Bar.html';
    let tooltip = null;

    function showTooltip(text, x, y) {
      if (!tooltip) {
        tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        document.body.appendChild(tooltip);
      }
      tooltip.textContent = text;
      tooltip.style.left = x + 'px';
      tooltip.style.top = y + 'px';
      tooltip.style.opacity = '1';
      
      setTimeout(() => {
        tooltip.style.opacity = '0';
        setTimeout(() => {
          if (tooltip) {
            tooltip.remove();
            tooltip = null;
          }
        }, 200);
      }, 2000);
    }

    async function copyUrl() {
      const url = document.getElementById('url').textContent;
      try {
        await navigator.clipboard.writeText(url);
        const button = document.querySelector('.copy-button');
        const rect = button.getBoundingClientRect();
        showTooltip('URL copi√©e !', rect.left, rect.top - 30);
      } catch (err) {
        console.error('Erreur lors de la copie:', err);
      }
    }

    function updateUrl() {
      const params = new URLSearchParams();
      
      // Personnalisation
      const accent = document.getElementById('accent').value;
      if (accent !== '#FCA000') params.set('accent', accent);

      const text = document.getElementById('text').value;
      if (text !== '#f2f5f8') params.set('text', text);

      const muted = document.getElementById('muted').value;
      if (muted !== '#96a0aa') params.set('muted', muted);

      const barBg = document.getElementById('barBg').value;
      const barBgAlpha = document.getElementById('barBgAlpha').value;
      if (barBg !== '#000000' || barBgAlpha !== '0.4') {
        const rgba = `rgba(${parseInt(barBg.slice(1,3),16)},${parseInt(barBg.slice(3,5),16)},${parseInt(barBg.slice(5,7),16)},${barBgAlpha})`;
        params.set('barBg', rgba);
      }

      // Taille du texte
      const fontScale = document.getElementById('fontScale').value;
      if (fontScale !== '1.0') params.set('fs', fontScale);

      // Contenu
      const hashtag = document.getElementById('hashtag').value;
      if (hashtag && hashtag !== '#CDC2025') params.set('hashtag', hashtag);

      const logo = document.getElementById('logo').value;
      if (logo) params.set('logo', logo);

      // G√©n√©rer l'URL finale
      const url = `${BASE_URL}${params.toString() ? '?' + params.toString() : ''}`;
      
      // Mettre √† jour l'affichage
      document.getElementById('url').textContent = url;
      // Mettre √† jour tous les aper√ßus
      document.getElementById('preview-full').src = url;
      
      // Aper√ßu des couleurs uniquement
      const colorParams = new URLSearchParams();
      if (accent !== '#FCA000') colorParams.set('accent', accent);
      if (text !== '#f2f5f8') colorParams.set('text', text);
      if (muted !== '#96a0aa') colorParams.set('muted', muted);
      if (barBg !== '#000000' || barBgAlpha !== '0.4') {
        const rgba = `rgba(${parseInt(barBg.slice(1,3),16)},${parseInt(barBg.slice(3,5),16)},${parseInt(barBg.slice(5,7),16)},${barBgAlpha})`;
        colorParams.set('barBg', rgba);
      }
      document.getElementById('preview-colors').src = `${BASE_URL}${colorParams.toString() ? '?' + colorParams.toString() : ''}`;

      // Aper√ßu de la taille de police uniquement
      const fontParams = new URLSearchParams();
      if (fontScale !== '1.0') fontParams.set('fs', fontScale);
      document.getElementById('preview-font').src = `${BASE_URL}${fontParams.toString() ? '?' + fontParams.toString() : ''}`;

      // Aper√ßu du contenu uniquement
      const contentParams = new URLSearchParams();
      if (hashtag && hashtag !== '#CDC2025') contentParams.set('hashtag', hashtag);
      if (logo) contentParams.set('logo', logo);
      document.getElementById('preview-content').src = `${BASE_URL}${contentParams.toString() ? '?' + contentParams.toString() : ''}`;
    }

    // Ajouter les √©v√©nements sur tous les champs
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', updateUrl);
    });

    // Initialiser l'URL
    updateUrl();
  </script>
</body>
</html>